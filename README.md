Лабораторная работа №1 "Применение дизассемблеров"

Выполнил: Воробьев Павел

Ход работы:
1. Получение исследуемого образца
Образец загружен из открытого репозитория вредоносных программ vx-underground (каталог: Samples → Families → Brbbot).

Первоначально файл был представлен в архиве формата .7z (пароль на архив: infected). После распаковки в архиве находился бинарный файл без расширения.
Размер: ~0.03 МБ

2. Анализ с использованием IDA Pro 9.2
Исследование производилось в дизассемблере IDA Pro 9.2.

При загрузке файл был определён как:

Portable Executable (PE) for x86

MD5 c6a4535a37f6adeac107b22d9d1220ba 
SHA-1 fbcb05e331d91cdca0bd1410bead0d2e91c18e5d


2.1. Функция start

Функция start является начальной точкой выполнения всего загрузчика-распаковщика и выполняет ключевые подготовительные действия перед вызовом основного алгоритма декомпрессии.
Её основная задача — инициализировать окружение и установить указатели для процесса распаковки.

2.2 Функция sub_14001A4D2

Вспомогательная функция, которая, вероятно, реализует быструю операцию с памятью, такую как: блочное копирование,
заполнение памяти.

2.3 Функция sub_14001A510

Главная функция, разбитая на три последовательные фазы: декомпрессия, восстановление кода и разрешение импортов.

После выполнения всех этих фаз, управление будет передано на Original Entry Point  — фактическую точку входа в распакованную программу.

По данным Virustotal был использован упаковщик  UPX (3.91) [NRV,best] 

2.4 Анализ ипортируемых билиотек 

Импортируемые DLL подтверждают, что финальный пейлоад (Brbbot) является:

Сетевым компонентом (WS2_32 / WININET): Его основная задача — соединяться с удаленным сервером и обмениваться данными.
Компонентом с механизмами настойчивости 
(ADVAPI32 / KERNEL32): Он способен устанавливаться в системе и запускаться при перезагрузке.
Скрытым (USER32): Он работает без видимого пользовательского интерфейса.

Вся сложная логика распаковщика (sub_14001A510) служит одной цели: скрыть эти вызовы API от статического анализаторов до того, как код будет запущен и выполнит динамическое разрешение импортов.


3. Вывод по результатам анализа

Исследуемый файл потенциально является ботом, который устанавливает соединение с удаленным сервером  для получения команд и обмена данными. Использование ADVAPI32.DLL и KERNEL32.DLL позволяет боту устанавливать механизмы настойчивости (автозапуск через Реестр) и манипулировать системными ресурсами.

Для полного анализа вредоносного ПО необходимы дополнительные инструменты анализа .NET.


